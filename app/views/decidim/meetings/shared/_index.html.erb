<% add_decidim_page_title(t("decidim.meetings.directory.meetings.index.meetings")) %>

<%= append_stylesheet_pack_tag "decidim_meetings", media: "all" %>
<%= append_javascript_pack_tag "decidim_meetings" %>
<% title = component.present? ? translated_attribute(component.name) : t("decidim.components.meetings.name") %>

<section role="region" aria-label=<%= t(".header") %>>
  <div class="row column component-background">
    <div class="one-col mx-auto space-y-4">
      <h1 class="title-decorator text-center h2 md:h1"><%= title %></h1>

      <%= render partial: "decidim/shared/components/intro" %>

      <% if try(:component_settings) && component_settings&.creation_enabled_for_participants? && current_component.participatory_space.can_participate?(current_user) %>
        <div class="mx-auto flex flex-col gap-4 items-center lg:flex-row">
          <%= action_authorized_link_to :create, new_meeting_path, class: "button button__lg button__secondary", data: { "redirect_url" => new_meeting_path} do %>
            <span><%= t("new_meeting", scope: "decidim.meetings.meetings.index") %></span>
            <%= icon "add-line" %>
          <% end %>
        </div>
      <% end %>
    </div>
  </div>

  <div class="row column one-col mx-auto">
    <% unless meetings.length.zero? %>
      <h2 id="meeting-count" class="h3 decorator md:h2">
        <%= t("meetings_count", scope: "decidim.meetings.meetings.count", count: meetings.total_count) %>
      </h2>
    <% end %>
  </div>
</section>

<main>
  <div class="double-col_off mx-auto">
    <div>
      <div>
        <%= render partial: "decidim/meetings/shared/filters", locals: {
              search_variable:,
              filter_options: filter_options || {}
            } %>
      </div>

      <% if display_announcement %>
        <%= render partial: "decidim/shared/component_announcement" %>
      <% end %>
    </div>

    <div id="meetings" class="layout-main__section layout-main__heading w-full">
      <% if display_map %>
        <div class="meetings-list__map">
          <%= cell "decidim/meetings/meetings_map", search.result %>
        </div>
      <% end %>

      <%= render partial: "decidim/meetings/shared/meetings", locals: { component: } %>
    </div>
  </div>
</main>
